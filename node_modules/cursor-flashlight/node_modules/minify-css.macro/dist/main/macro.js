"use strict";

exports.__esModule = true;
exports.default = void 0;

var _generator = /*#__PURE__*/_interopRequireDefault( /*#__PURE__*/require("@babel/generator"));

var _babelPluginMacros = /*#__PURE__*/require("babel-plugin-macros");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _ref(p, node) {
  if (!node.loc) return p;
  p[`${node.loc.start.line}:${node.loc.start.column}`] = `\${${(0, _generator.default)(node).code}}`;
  return p;
}

function _ref2(str) {
  return parseInt(str);
}

function _ref3(str) {
  return parseInt(str);
}

function _ref4(a, b) {
  const [a0, a1] = a.split(':').map(_ref2);
  const [b0, b1] = b.split(':').map(_ref3);

  if (a0 === b0) {
    return a1 - b1;
  }

  return a0 - b0;
}

function _ref5(referencePath) {
  if ('quasi' in referencePath.parentPath.node) {
    const result = referencePath.parentPath.node.quasi.expressions.reduce(_ref, {});
    referencePath.parentPath.node.quasi.quasis.forEach(node => {
      if (!node.loc) return;
      result[`${node.loc.start.line}:${node.loc.start.column}`] = node.value.raw.replace(/\s{2,}|\n|\t/g, ' ').replace(/([:;,([{}>~/])\s+/g, '$1').replace(/\s+([;,)\]{}>~/!])/g, '$1').replace(/\/\*\s+/, '/*').replace(/\s+\*\//, '*/');
    });
    const keys = Object.keys(result);
    keys.sort(_ref4);
    referencePath.parentPath.replaceWithSourceString(`\`${keys.map(k => result[k]).join('').trim()}\``);
  }
}

var _default = /*#__PURE__*/(0, _babelPluginMacros.createMacro)(function evaluateMacros({
  references
}) {
  references.default.forEach(_ref5);
});

exports.default = _default;